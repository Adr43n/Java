import java.util.ArrayList;
import java.util.List;

/**
 * Classe représentant une banque avec une liste de comptes bancaires.
 */
public class Banque {
    private String libelle;
    private List<CompteBancaire> comptes;

    /**
     * Constructeur de la banque.
     * @param libelle Nom de la banque
     */
    public Banque(String libelle) {
        this.libelle = libelle;
        this.comptes = new ArrayList<>();
    }

    /**
     * Retourne le libellé de la banque.
     * @return libellé de la banque
     */
    public String getLibelle() {
        return libelle;
    }

    public boolean estCompteExistant(String numero) {
        return this.getCompte(numero) != null;
    }

   
    public CompteBancaire getCompte(String numero) {
        for (CompteBancaire c : this.comptes) {
            if (c.getNuméro().equals(numero)) {
                return c;
            }
        }
        return null;
    }
    
    public void ouvrir(String numero, float valeur) throws IllegalArgumentException {
        if (this.estCompteExistant(numero) || valeur < 0) {
            throw new IllegalArgumentException("Compte existant ou montant invalide : " + numero);
        }
        CompteBancaire c = new CompteBancaire(numero);
        c.déposer(valeur);
        this.comptes.add(c);
    }

   
    public void ouvrir(String numero, float taux, float valeur) throws IllegalArgumentException {
        if (this.estCompteExistant(numero) || valeur < 0) {
            throw new IllegalArgumentException("Compte existant ou montant invalide : " + numero);
        }
        CompteEpargne c = new CompteEpargne(numero, taux);
        c.déposer(valeur);
        this.comptes.add(c);
    }

    
    public void fermer(String numero) throws IllegalArgumentException {
        CompteBancaire c = this.getCompte(numero);
        if (c == null || c.solde() != 0) {
            throw new IllegalArgumentException("Compte inexistant ou solde non nul : " + numero);
        }
        this.comptes.remove(c);
    }

    /**
     * Calcule le solde total de la banque.
     * @return solde total de la banque
     */
    public float solde() {
        float total = 0;
        for (CompteBancaire c : this.comptes) {
            total += c.solde();
        }
        return total;
    }

   
    public void deposer(String numero, float valeur) throws IllegalArgumentException {
        CompteBancaire c = this.getCompte(numero);
        if (c == null || valeur < 0) {
            throw new IllegalArgumentException("Compte inexistant ou montant invalide : " + numero);
        }
        c.déposer(valeur);
    }

 
    public void retirer(String numero, float valeur) throws IllegalArgumentException {
        CompteBancaire c = this.getCompte(numero);
        if (c == null || valeur < 0) {
            throw new IllegalArgumentException("Compte inexistant ou montant invalide : " + numero);
        }
        c.retirer(valeur);
    }

    
    

    /**
     * Retourne une représentation textuelle de la banque et de ses comptes.
     * @return Chaîne de caractères représentant la banque
     */
    @Override
    public String toString() {
        StringBuilder r = new StringBuilder("[Banque : " + this.libelle);
        for (CompteBancaire c : this.comptes) {
            r.append("\nNuméro : ").append(c.getNuméro())
             .append(", Crédit : ").append(c.solde())
             .append(", Débit : 0.0");
        }
        return r.append("]").toString();
    }
}
